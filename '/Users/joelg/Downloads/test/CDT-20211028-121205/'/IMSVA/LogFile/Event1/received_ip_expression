#this file for storing the regular expressions of received IP in received header, after changing this file, please restart foxproxyd manually
#here is only one rule for these regular expressions:the more special the front
#if there are no any regular expressions in this file, foxproxyd will load the default regular expression which hard coding in program.

#NOTE: the following is an priority list. Do not change the order if there is no reason!!!
#For parsing some sender send mail with helo IP. 
#e.g.: Received: from [211.239.153.209] ([150.70.98.119])    by In-MTA with Trend Micro Email Security Platform for SP id NADq1p0042aYpF201AEJgx; Mon, 01 Dec 201410:14:23 +0000
#the previous expression get the 211.239.153.209, the correct IP is 150.70.98.119
.*\s*from\s+.*?[\(\[]{1,2}(?:\s*|(?:.*?\D))(((25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(25[0-5]|2[0-4]\d|[01]?\d\d?))\s*[\)\]]{1,2}(\s*by\s|\sby\s*).*

#For the header, there is other information in ()
#e.g. Received: from [10.248.173.14] ([10.248.173.14:58656] helo=eu6-app1-19-frf.ops.sfdc.net)by mx1-frf-sp1.mta.salesforce.com (envelope-from <sally.mackerness=keenpac.co.uk__ala5uyph7d1z0xtz@z7hgpp7y8qkh.58-i6wzeac.eu6.bnc.salesforce.com>)(ecelerity 3.6.25.56547 r(Core:3.6.25.0)) with ESMTPS (cipher=DES-CBC3-SHA) id 4D/A9-07976-16F99095; Wed, 03 May 2017 09:14:09 +0000
.*\s*from\s+.*[\(\[]{1,2}(?:\s*|(?:.*?\D))(((25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(25[0-5]|2[0-4]\d|[01]?\d\d?)).*[\)\]]{1,2}(\s*by\s|\sby\s*).*

#for parsing received IP(IPv4):Received: from spam-IMSS(123.123.123.123) by RaidenMAILD([10.0.0.7]); Fri, 5 Sep 2003 14:04:01 +0800
.*\s*from\s+.*?[\(\[]{1,2}(?:\s*|(?:.*?\D))(((25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(25[0-5]|2[0-4]\d|[01]?\d\d?))\s*[\)\]].*

#for parsing received IP(special IPv6 format):Received: from test.com (unknown [IPv6:1234:1234:1234:1234:1234:1234:1234:1234])
.*\s*from\s+.*?[\(\[].*?v6:(([\da-fA-F]{0,4}:){1,7}[\da-fA-F]{1,4}).*[\)\]].*

#for parsing received IP(IPv6 basic format):Received: from test.com (unknown [1234:1234:1234:1234:1234:1234:1234:1234])
.*\s*from\s+.*?[\(\[].*?(([\da-fA-F]{0,4}:){1,7}[\da-fA-F]{1,4}).*[\)\]].*

#for Postfix/SendMail
.*.*\s*from\s+.*?\[(.+)\].*
